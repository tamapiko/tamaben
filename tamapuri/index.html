<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>タマプリツール</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<h1>
  <button class="logo-button">
    <img src="logo.svg" alt="ロゴ" class="logo-image">
    <span class="logo-text">タマプリツール</span>
  </button>
</h1>

<div class="layout">
  <div class="sidebar">
    <h3>アップロード</h3>
    <input type="file" accept=".pdf, image/*"><br><br>

    <h3>テンプレート</h3>
    <button onclick="loadTemplate()">タマベンテンプレート</button><br><br>

    <h3>プリントサイズ</h3>
    <select id="sizeSelector" onchange="changePrintSize()">
      <option value="A4">A4</option>
      <option value="A3">A3</option>
      <option value="A5">A5</option>
    </select>

    <div class="print-preview">
      <h3>作成プリント</h3>
      <img src="tenp.pdf" alt="プリントテンプレートプレビュー">
    </div>
  </div>
  <div class="editor">
    <div class="print-area" id="printArea"></div>
  </div>
</div>

<!-- ボタンバー -->
<div class="button-bar">
  <button onclick="addTextBox()">
    <img src="logo.svg" alt="ロゴ" width="20"> テキスト
  </button>
  <button onclick="addAnswerBox()">解答欄</button>
  <button onclick="saveAsPdf()">PDF</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  function addTextBox() {
    const div = document.createElement("div");
    div.contentEditable = true;
    div.className = "editable resize";
    div.textContent = "編集テキスト";
    div.style.border = "1px dashed #888";
    div.style.padding = "5px";
    div.style.margin = "10px 0";
    div.style.minWidth = "100px";
    div.style.minHeight = "30px";
    document.getElementById("printArea").appendChild(div);
  }

  function addAnswerBox() {
    const div = document.createElement("div");
    div.className = "resize";
    div.style.border = "2px solid #000";
    div.style.margin = "10px 0";
    div.style.height = "40px";
    div.style.width = "100%";
    document.getElementById("printArea").appendChild(div);
  }

  function changePrintSize() {
    const area = document.getElementById("printArea");
    const size = document.getElementById("sizeSelector").value;
    switch(size) {
      case 'A3': area.style.minHeight = "1150px"; break;
      case 'A5': area.style.minHeight = "600px"; break;
      default: area.style.minHeight = "800px";
    }
  }

  function saveAsPdf() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF("p", "pt", "a4");
    doc.html(document.getElementById("printArea"), {
      callback: function (doc) {
        doc.save("tama_print.pdf");
      },
      x: 10,
      y: 10
    });
  }

  function loadTemplate() {
    const area = document.getElementById("printArea");
    area.innerHTML = '';
    const embed = document.createElement("embed");
    embed.src = "tenp.pdf";
    embed.type = "application/pdf";
    embed.width = "100%";
    embed.height = "1000px";
    embed.style.border = "1px solid #ccc";
    embed.style.borderRadius = "8px";
    area.appendChild(embed);
  }
</script>

</body>
</html>
